using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Data;
using System.Data.SqlClient;
using System.Text;


namespace TolkRoute1._9
{
    class sjaelland
    {
        static string[,] cPostCodesArray = new string[,]
        {
		{ "2791",	    "2770",	    null,       null,	    null,	        null,          null },// N W S E

		{ "2770",		"2300",	    "2650",		"2791",       null,	        null,          null	}, 

		{ "2300",	    "1000",	    "2450",		null,       null,	        null,          null },

		{ "2650",		"2500",		"2605",		null,	    "2770",         "2610",        "2660"},

		{ "2450",		"1500",		"2500",		"2300",		null,           null,           null },

		{ "2500",		"1800",		"2610",		"2450",	    "2650",         "1500",        "2720"},

		{ "2610",		"2730",		"2740",		"2600",     "2650",         "2500",         null },

		{ "2605",		"2600",		"2625",		"2660",	    "2650",         null,           null },

		{ "2660",		"2605",		"2665",		"2650",	    null,           null,           null },

		{ "2600",		"2740",		"2620",		"2605",	    "2610",         null,           null },

		{ "2620",		"2750",		"2765",		"2630",	    "2625",         "2600",         null },
       
        { "2625",		"2620",		"2635",		"2665",	    "2605",         "2660",           null },

        { "2665",		"2625",		"2635",		"2660",	    null,           null,           null },

        { "2630",		"2765",		"2640",		"2635",	    "2620",         null,           null },

        { "2635",		"2630",		"2670",		"2625",	    "2665",         "2640",         null },

        { "2640",		"2630",		"2635",		"4030",	    "4000",           null,           null },

        { "2670",		"2635",		"2640",		"4030",		"2690",	    null,           null},

        { "2690",		"2670",		"4030",		"4621",	    "4622",    "2680",           null },
        
        { "2680",		"2690",		"4622",		"4623",	    "4600",           null,           null },

        { "1000",		"2100",		"2200",		"1800",	    "1500",         "2300",         null },

        { "1500",		"1800",		"2500",		"2450",	    "1000",         null,           null },

        { "2200",		"2400",		"1800",		"1000",	    null,           null,           null },

        { "2100",		"2900",		"2400",		"1000",	    null,           null,           null },

        { "1800",		"2400",		"2720",		"2500",	    "1500",     "2200",      "1000"	},

        { "2720",		"2700",		"2610",		"2500",	    "1800",     null,      null	},

        { "2700",		"2730",		"2610",		"2400",	    "2860",     null,      null	},

        { "2400",		"2860",		"2700",		"1800",	    "2200",     "2100",      "2900"	},

        { "2900",		"2920",		"2400",		"2100",	    null,     null,      null	},

        { "2860",		"2820",		"2730",		"2700",	    "2400",     null,      null	},

        { "2740",		"2730",		"2750",		"2600",	    "2610",     null,      null	},

        { "2765",		"2760",		"3670",		"4000",	    "2630",     "2620",      "2750"	},

        { "2760",		"2765",		"2750",		"3500",	    "3660",     "3670",      null	},

        { "2750",		"2760",		"2620",		"2740",	    "2730",     "3500",      "2765"	},

        { "2730",		"2880",		"2750",		"2740",	    "2610",     "2700",      "2860"	},

        { "2820",		"2800",		"2860",		"2920",	    "2900",     null,      null	},

        { "2920",		"2930",		"2820",		"2900",	    null,     null,      null	},

        { "2930",		"2942",		"2800",		"2920",	    null,     null,      null	},

        { "2800",		"2850",		"2830",		"2880",	    "2860",     "2820",      "2930"	}, // 3 more pc are linked, 2840, 3500, 2942

        { "2880",		"2830",		"2730",		"2800",	    "2860",     null,      null	},

        { "2830",		"2840",		"2880",		"2800",	    "3500",     null,      null	},

        { "2840",		"2970",		"2830",		"2800",	    "2850",     "2950",      "3460"	},

        { "2850",		"2950",		"2840",		"2800",	    "2942",     null,      null	},

        { "2942",		"2950",		"2850",		"2930",	    null,     null,      null	},

        { "2950",		"2960",		"2970",		"2840",	    "2850",     "2942",      null	},

        { "2960",		"2980",		"2970",		"2950",	    null,     null,      null	},

        { "2970",		"2980",		"2840",		"2950",	    "2960",     null,      null	},

        { "2980",		"2990",		"2970",		"2960",	    "3480",     null,      null	},

        { "2990",		"3050",		"2980",		"2960",	    "3480",     null,      null	},

        { "3050",		"2990",		"3060",		"3490",	    "3480",     null,      null	},

        { "3060",		"3070",		"3000",		"3490",	    "3050",     null,      null	},

        { "3070",		"3000",		"3060",		null,	    null,     null,      null	},

        { "3000",		"3150",		"3140",		"3100",	    "3080",   "3490",   "3060"	}, // there is one more postcode linked 3070, but it is not added now

        { "3150",		"3140",		"3000",		null,	    null,     null,      null	},

        { "3140",		"3100",		"3000",		"3150",	    null,     null,      null	},

        { "3100",		"3120",		"3230",		"3080",	    "3000",  "3140",      null	},

        { "3080",		"3100",		"3230",		"3480",	    "3490",   "3000",      null	},

        { "3490",		"3000",		"3080",		"3480",	    "3050",    "3060",      null	},

        { "3120",		"3250",		"3230",		"3100",	    null,     null,      null	},

        { "3250",		"3210",		"3230",		"3120",	    null,     null,      null	},

        { "3230",		"3120",		"3250",		"3210",	    "3200",   "3480",    "3080"	}, // there is one more postcode linked 3100, but it is not added now

        { "3210",       "3220",		"3200",		"3230",	    null,     null,      null },

        { "3480",		"3080",		"3230",		"3400",	    "2980",    "3050",    "3490"	}, // there is one more 2990

        { "3200",		"3210",		"3230",		"3220",	    "3300",     "3320",     "3400"	}, //3480

        { "3400",		"3200",		"3320",		"3330",	    "3450",     "2980",     "3480"	},

        { "3220",		"3210",		"3300",		"3200",	    null,       null,     null	},

        { "3300",		"3220",		"3360",		"3370",	    "3310",     "3320",     "3200"	},

        { "3320",		"3200",		"3300",		"3310",	    "3600",     "3330",     "3400"	}, //3550

        { "3310",		"3300",		"3600",		"3320",	    null,     null,     null	},

        { "3330",		"3400",		"3320",		"3550",	   null,     null,     null	},

        { "3600",		"3320",		"3310",		"4040",	    "3650",     "3550",    null	},

        { "3550",		"3330",		"3320",		"3600",	    "3650",     "3660",     "3540"	}, // 3400, 3450

        { "3450",		"3400",		"3550",		"3540",	    "3520",     "3460",     "2970"	},

        { "3540",		"3450",		"3550",		"3660",	    "3520",     null,     null	},

        { "3460",		"2970",		"3450",		"3520",	    "2840",     null,     null	},

        { "3520",		"3450",		"3540",		"3660",	    "3500",     "2840",     "3460"	},

        { "3500",		"3520",		"3660",		"2760",	    "2750",     "2730",     "2880"	}, // 2830

        { "3650",		"3550",		"3600",		"4040",	    "4000",     "3660",    null	},

        { "3660",		"3540",		"3550",		"3650",	    "3670",     "3520",     "3500"	}, //4000, 2760

        { "3360",		"3370",		"3300",		null,     null,     null,     null	},

        { "3370",	    "3360",   "3390",		"3300",		null,     null,     null},

        { "3390",		"3370",		null,		null,     null,     null,     null	},

        { "3670",		"3660",		"4000",		"2765",	    "2760",  null,    null	},

        { "4040",		"3600",		"4000",		"3650",	    null,  null,    null	},

        { "4000",		"3670",		"3650",		"4040",	    "4320",  "4130",  "2640"	}, // 4060, 4330, 4621, 4030, 3660

        { "4030",		"2640",		"4000",		"4621",	    "2690",  null,    null	},

        { "4320",		"4000",		"4330",		"4174",	    "4140",  "4130",    null	},

        { "4130",		"4000",		"4320",		"4140",	    "4623",  "4622",   "4621"	},

         { "4621",		"4000",		"4130",		"4622",	    "4030", "2690",    null	},

         { "4622",		"4621",		"4130",		"4623",	    "2680",  null,    null		},

         { "4623",		"2680",		"4622",		"4130",	    "4140",  "4632",   "4600"	},

         { "4140",		"4130",		"4320",		"4174",	    "4100",  "4632",   null	},

         { "4330",		"4060",		"4340",		"4360",	    "4174",  "4320",   "4000"	},

         { "4174",		"4330",		"4360",		"4370",	    "4100",  "4140",   "4320"	},

          { "4100",		"4174",		"4180",		"4173",	    "4690",  "4682",   "4140"	}, // 4370, 4171, 4160, 4296, 4632

          { "4632",		"4623",		"4140",		"4100",	    "4682",  "4681",   "4600"	},

          { "4600",		"4623",		"4632",		"4681",	    "4652",  "4671",   null	},

          { "4681",		"4600",		"4632",		"4682",	    "4652",  null,   null	},

          { "4682",		"4681",		"4100",		"4690",	    "4640",  "4653",   "4652"	}, //4632

          { "4652",		"4600",		"4682",		"4653",	    "4660",  "4672",   "4671"	}, //4681

          { "4671",		"4600",		"4652",		"4672",	    null, 	null,   null},

          { "4672",		"4671",		"4652",		"4660",	   null, 	null,   null},

          { "4653",		"4652",		"4682",		"4690",	    "4640",  "4660",   null	},

          { "4660",		"4672",		"4652",		"4653",	    "4640",  "4673",   null	},

          { "4673",		"4660",		"4640",		null,	   null, 	null,   null	},

          { "4640",		"4653",		"4690",	    "4683",  "4733",   "4654",		"4673"	}, //4682

          { "4654",		"4640",		null,		null,	   null, 	null,   null	},

          { "4690",		"4653",		"4690",	    "4683",  "4733",   "4654",		"4673"	}, //********************************  49+58

          { "4171",		"4173",		"4180",	    "4250",  "4160",   "4100",	null},

          { "4261",		"4200",		"4230",	    "4243",  "4262",   "4250",	null}, //

          { "4243",		"4261",		"4230",	    "4262",  null,   null,	null}, //
          
          { "4230",		"4200",		"4242",	    "4243",  "4261",   null,	null}, //
          
          { "4242",		"4241",		"4220",	    "4230",  "4200",   null,	null}, //

          { "4220",		"4241",		"4242",	    null,  null,   null,	null}, //

          { "4241",		"4200",		"4220",	    "4242",  null,   null,	null}, //

          { "4200",		"4291",		"4270",	    "4241",  "4261",   "4250",	"4180"}, // 4281, 4230, 4242, 4190

          { "4190",		"4293",		"4200",	    "4180",  "4295",   null,	null}, // 

          { "4295",		"4440",		"4293",	    "4190",  "4180",   "4296",	"4350"}, // 4340

          { "4296",		"4350",		"4295",	    "4241",  "4180",   "4100",	"4370"}, // 

          { "4370",		"4340",		"4350",	    "4296",  "4100",   "4174",	"4360"}, // 

          { "4180",		"4295",		"4200",	    "4250",  "4171",   "4173",	"4100"}, // 4296, 4190

          { "4173",		"4180",		"4171",	    "4100",  null,   null,	null}, // 

          { "4360",		"4340",		"4370",	    "4174",  "4330",   null,	null}, // 

          { "4340",		"4390",		"4350",	    "4420",  "4360",   "4330",	"4060"}, // this postcode 4340 has a strange area located. // 4300, 4370, 4440, 4295, 

          { "4350",		"4300",		"4420",	    "4295",  "4296",   "4370",	"4340"}, // 

          { "4293",		"4440",		"4291",	    "4190",  "4295",   null,	null}, // 

          { "4291",		"4450",		"4490",	    "4270",  "4200",   "4293",	null}, // 4470, 4190

          { "4270",		"4490",		"4480",	    "4281",  "4200",   "4291",	null}, //

          { "4281",		"4480",		"4200",	    "4270",  null,   null,	null}, //

          {"4480",		"4490",		"4400",	    "4281",  "4270",   "4291",	null}, //

          {"4490",		"4470",		"4400",	    "4281",  "4270",   "4291",	"4450"}, //

          {"4400",		"4480",		"4490",	    "4470",  "4593",   null,	null}, //

          {"4470",		"4593",		"4400",	    "4490",  "4291",   "4450",	null}, //

          {"4450",		"4460",		"4593",	    "4470",  "4291",   "4440",	"4520"}, //

          {"4440",		"4520",		"4450",	    "4293",  "4295",   "4340",	"4420"}, // 4291

          {"4420",		"4532",		"4520",	    "4450",  "4340",   "4350",	"4300"}, //

          {"4300",		"4571",		"4532",	    "4420",  "4350",   "4340",	"4390"}, //

          {"4390",		"4300",		"4340",	    "4060",  null,  null,	null}, //

          {"4060",		"4390",		"4340",	    "4330",  "4000",   "4070",	null}, //

          {"4070",		"4050",		"4060",	    null,       null,       null,	null}, //

          {"4050",		"3630",		"4070",	    null,       null,       null,	null}, //

          {"3630",		"4050",		null,	    null,       null,       null,	null}, //

          {"4532",		"4571",		"4520",	    "4420",  "4300",   null,    null}, //

          {"4520",		"4571",		"4534",	    "4450",  "4440",   "4420",	"4532"}, // 4460, 

          {"4460",		"4534",		"4591",	    "4593",  "4450",   "4520",	null}, //

          {"4593",		"4400",		"4470",	    "4450",  "4460",   "4591",	null}, //

          {"4591",		"4534",		"4593",	    "4460",  null,      null,       null}, //

          {"4534",		"4540",		"4591",	    "4460",  "4520",   "4571",	"4550"}, //

          {"4540",		"4550",		"4534",	    "4571",  null,   null,      null}, //

          {"4550",		"4560",		"4540",	    "4571",  null, null, null}, //

          {"4571",		"4560",		"4550",	    "4520",  "4300",   null,    null}, //

          {"4560",		"4573",		"4550",	    "4571",  "4500",   "4572",  null}, //

          {"4572",		"4573",		"4560",	    "4500",  null, null, null}, //

          {"4573",		"4500",		"4560",	    "4572",  null, null, null}, //

          {"4500",		"4581",		"4583",	    "4573",  "4572",   "4560",	null}, //

          {"4583",		"4500",		null, null, null, null, null}, //

          {"4581",		"4500",		null, null, null, null, null}, //
          
          {"4700",		"4160",		"4262",	    "4736",  "4750",   "4733",	"4684"}, //4250,
          {"4262",		"4250",		"4261",	    "4243",  "4700",   null,	null}, //
          {"4733",		"4683",		"4684",     "4700",  "4640",	null,   null}, //
          {"4250",		"4180",		"4200",	    "4261",  "4262",   "4700",	"4171"}, //4160
          {"4750",		"4700",		 null,      null,     null,     null,	null}, 
          { "4684",		"4690",		"4160",	    "4700",  "4733",   "4683",	null},
          { "4160",		"4100",		"4171",	    "4250",  "4700",   "4684",	"4690"},
          { "4683",		"4690",		"4684",	    "4733",  "4640",    null,   null},
          { "4736",		"4700",		null,	    null,     null,     null,	null},//***********      166
          


	};

        public Hashtable sjaelandHash;

        public sjaelland()
        {
            addPostcodes();
        }
        public void addPostcodes()
        {
            sjaelandHash = new Hashtable();
            for (int i = 0; i < 165; i++)
            {
                PostCode pEnteringHas = new PostCode(cPostCodesArray[i, 0]);
                sjaelandHash.Add(cPostCodesArray[i, 0], pEnteringHas);
            }

            for (int i = 0; i < 165; i++)
            {
                PostCode AddExitToEachPInHash = (PostCode)sjaelandHash[cPostCodesArray[i, 0]];
                //Console.WriteLine(" aray is " + cPostCodesArray[i, 0]);
                for (int j = 1; j < 7; j++)
                {
                    if (cPostCodesArray[i, j] != null)
                        AddExitToEachPInHash.addExitPostCode((PostCode)sjaelandHash[cPostCodesArray[i, j]]);
                }

            }
        }

        public string TolkNearby(PostCode OrderPc, string OderLanguage)
        {
            string returnPostCode = "";
            //PostCode returnP = new PostCode("empty");
            IEnumerator ie = sjaelandHash.Values.GetEnumerator();
            while (ie.MoveNext())
            {
                PostCode p = (PostCode)ie.Current;
                p.parent = null;
            }

            Queue todo = new Queue();
            todo.Enqueue(sjaelandHash[OrderPc.lable]);

            while (todo.Count > 0)
            {
                int exitloop = 0;
                PostCode p = (PostCode)todo.Dequeue();
                for (int i = 0; i < p.ActiveTolkInPcList.Count; i++)
                {
                    for (int j = 0; j < p.ActiveTolkInPcList[i].cTlangList.Count; j++)
                    {
                        if (OderLanguage == p.ActiveTolkInPcList[i].cTlangList[j])
                        {
                            returnPostCode = p.lable;
                            //returnP = p;
                            //Console.WriteLine("     Tolk Name: " + p.ActiveTolkInPcList[i].cTname + ", Post Code: " + p.lable + " Language: " + p.ActiveTolkInPcList[i].cTlangList[j]);
                            //p.ActiveTolkInPcList.RemoveAt(i);
                            exitloop = 1;
                            break;
                        }

                    }
                    if (exitloop == 1)
                    {
                        break;
                    }
                }
                if (exitloop == 1)
                {
                    break;
                }
                IEnumerator iePostCode = p.PostCodeHash.Values.GetEnumerator();
                while (iePostCode.MoveNext())
                {
                    PostCode pnull = (PostCode)iePostCode.Current;
                    if (pnull.parent == null)
                    {
                        todo.Enqueue(pnull);
                        pnull.parent = p;
                    }
                }

            }
            return returnPostCode;
            //return returnP;
        }


    }
}
